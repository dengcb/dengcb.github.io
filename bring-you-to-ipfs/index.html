<!DOCTYPE html>
<html class="has-navbar-fixed-top">
<head>
    <meta charset="utf-8">
<title>Bring You to IPFS - dengcb</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/outdated-browser/1.1.5/outdatedbrowser.min.css">






<link rel="icon" href="/favicon.png">


<link rel="stylesheet" href="//fonts.googleapis.com/css?family=Ovo|Source+Code+Pro">
<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/bulma/0.6.2/css/bulma.min.css">


<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/lightgallery/1.6.8/css/lightgallery.min.css">
<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/justifiedGallery/3.6.5/css/justifiedGallery.min.css">


<link rel="stylesheet" href="/css/style.css">
<script defer src="//use.fontawesome.com/releases/v5.0.8/js/all.js"></script>

</head>
<body>
    
<nav class="navbar is-transparent is-fixed-top navbar-main" role="navigation" aria-label="main navigation">
    <div class="container">
        <div class="navbar-brand">
            <a class="navbar-item navbar-logo" href="/">
                
                <img src="/images/logo.png" alt="" height="28">
                
            </a>
            <div class="navbar-burger">
                <span></span>
                <span></span>
                <span></span>
            </div>
        </div>
        
        <div class="navbar-menu navbar-start">
            
            <a class="navbar-item "
               href="/archives">Archive</a>
            
            <a class="navbar-item "
               href="/categories">Category</a>
            
            <a class="navbar-item "
               href="/tags">Tag</a>
            
            <a class="navbar-item "
               href="/about">About</a>
            
        </div>
        
        <div class="navbar-menu navbar-end">
            
            <a class="navbar-item search" href="javascript:;">
                <i class="fas fa-search"></i>
            </a>
            
            
            
            <a class="navbar-item" href="https://github.com/dengcb">
                
                <i class="fab fa-github"></i>
                
            </a>
               
            
        </div>
    </div>
</nav>

    <section class="section">
    <div class="container">
    <article class="article content gallery" itemscope itemprop="blogPost">
    <h1 class="article-title is-size-3 is-size-4-mobile" itemprop="name">
        
            Bring You to IPFS
        
    </h1>
    <div class="article-meta columns is-variable is-1 is-multiline is-mobile is-size-7-mobile">
        <span class="column is-narrow">
            <time datetime="2018-04-19T15:35:11.000Z" itemprop="datePublished">14 days ago</time>
        </span>
        
        <span class="column is-narrow article-category">
            <i class="far fa-folder"></i>
            <a class="article-category-link" href="/categories/web/">web</a><span>></span><a class="article-category-link" href="/categories/web/ipfs/">ipfs</a>
        </span>
        
        
        <span class="column is-narrow">
            
            
            5 minutes read (About 771 words)
        </span>
        
    </div>
    <div class="article-entry is-size-6-mobile" itemprop="articleBody">
    
        <p>Last post, I use Hexo with Minos to build a full site multi-language blog, it’s exciting! So in this post, I will tell you how to bring the new blog to IPFS.</p>
<a id="more"></a>
<h2 id="What-is-IPFS"><a href="#What-is-IPFS" class="headerlink" title="What is IPFS"></a>What is IPFS</h2><blockquote><p>IPFS is called for short of <strong><em>InterPlanetary FileSystem</em></strong>, maybe you can visit your data from another galaxy. Due to the limit speed of light, we need quantum entanglement communication to play well.</p>
<footer><strong>dengcb</strong><cite><a href="https://dengcb.github.io" target="_blank" rel="noopener">Welcome to my GitHub</a></cite></footer></blockquote>
<p>IPFS uses data hash address instead of website domain, but in the next, you will find if you want to visit your data in IPFS within a traditional website, you still need domain. And to get hash data, you have to visit a IPFS node server. So, want to decentralize, you maybe need a centralized server first.</p>
<p>Meanwhile, distributed data storage will cause waste. Some updated files, previous versions are no longer valid, but are pinned and permanently retained inside IPFS and cannot be deleted. Even the owner has forgotten the previous data hash, the dead files become ghosts in the IPFS system.</p>
<h2 id="Install-IPFS"><a href="#Install-IPFS" class="headerlink" title="Install IPFS"></a>Install IPFS</h2><ul>
<li>Download latest release<ul>
<li>Open <a href="https://ipfs.io/docs/install/" target="_blank" rel="noopener">Official Site</a>, click <code>Download IPFS for your platform</code></li>
<li>Choose the binary for your platform, download and unzip</li>
</ul>
</li>
</ul>
<ul>
<li>Install IPFS package<ul>
<li>Such as MacOS, enter <code>go-ipfs</code>, and execute <code>./install.sh</code></li>
<li>If permission denied, add <code>sudo</code>, then copy the ipfs file into path</li>
<li>Execute <code>ipfs help</code> to test installed</li>
</ul>
</li>
</ul>
<ul>
<li><p>Initialize the node</p>
<ul>
<li>Execute <code>ipfs init</code>, init the folder <code>.ipfs</code> and create config files</li>
<li>Keep the <code>peer identity</code>, or find it in <code>~/.ipfs/config</code></li>
<li><p>Modify config file, set the storage space <code>vi ~/.ipfs/config</code></p>
<pre><code>&quot;Datastore&quot;: {
  &quot;StorageMax&quot;: &quot;6GB&quot;
}
</code></pre></li>
</ul>
</li>
</ul>
<ul>
<li>Start the daemon<ul>
<li>Execute <code>ipfs daemon &gt; ipfs.log &amp;</code>, start daemon as background process</li>
<li>Execute <code>ps ax|grep ipfs</code>, check the daemon alive</li>
</ul>
</li>
</ul>
<h2 id="Publish-to-IPFS"><a href="#Publish-to-IPFS" class="headerlink" title="Publish to IPFS"></a>Publish to IPFS</h2><ul>
<li>Build hexo site<ul>
<li>Please read my last post <a href="/hexo-minos-multi-language/">Hexo multi-language with Minos</a></li>
<li>Copy the public folder to IPFS node server</li>
</ul>
</li>
</ul>
<ul>
<li><p>Add to IPFS</p>
<ul>
<li>Execute <code>ipfs add -r public</code> to add public folder to IPFS</li>
<li>Keep the public hash</li>
<li><p>Persistent storage <code>ipfs pin add -r QmW2VrAeBhH6bCbeqnkhxV4iUYmEUDE2pCLMEAtaWzjD1q</code></p>
<blockquote>
<p>added <strong><em>QmW2VrAeBhH6bCbeqnkhxV4iUYmEUDE2pCLMEAtaWzjD1q</em></strong> public</p>
</blockquote>
<p>Visit <a href="https://ipfs.io/ipfs/QmW2VrAeBhH6bCbeqnkhxV4iUYmEUDE2pCLMEAtaWzjD1q" target="_blank" rel="noopener">https://ipfs.io/ipfs/QmW2VrAeBhH6bCbeqnkhxV4iUYmEUDE2pCLMEAtaWzjD1q</a> directly</p>
</li>
</ul>
</li>
</ul>
<ul>
<li><p>Name publish</p>
<ul>
<li><p>Execute below, bind node name with public folder hash</p>
<blockquote>
<p>ipfs name publish <strong><em>QmW2VrAeBhH6bCbeqnkhxV4iUYmEUDE2pCLMEAtaWzjD1q</em></strong></p>
</blockquote>
</li>
<li><p>Bind success, the name is the peer when node init</p>
<blockquote>
<p>Published to <strong><em>Qmdn4vrHjbmsQvHPXAiJvWFHQRqGd5fP33HJqd9AE4EjMH</em></strong>: /ipfs/QmW2VrAeBhH6bCbeqnkhxV4iUYmEUDE2pCLMEAtaWzjD1q</p>
</blockquote>
<p>Visit <a href="https://ipfs.io/ipns/Qmdn4vrHjbmsQvHPXAiJvWFHQRqGd5fP33HJqd9AE4EjMH" target="_blank" rel="noopener">https://ipfs.io/ipns/Qmdn4vrHjbmsQvHPXAiJvWFHQRqGd5fP33HJqd9AE4EjMH</a> namely</p>
</li>
<li><p><code>Note: name is fixed, hash is changed, so bind name just like stable IP address</code></p>
</li>
</ul>
</li>
</ul>
<h2 id="Config-domain"><a href="#Config-domain" class="headerlink" title="Config domain"></a>Config domain</h2><ul>
<li>Register domain<br>Just go Godaddy or other domainer</li>
</ul>
<ul>
<li><p>Change DNS Server<br>Now, please use <a href="https://www.cloudflare.com" target="_blank" rel="noopener">CloudFlare</a>, for some reason:</p>
<ul>
<li>Free DNS</li>
<li>Free https, dynamic and security</li>
</ul>
<p>Please set DNS Server as</p>
<blockquote>
<p>dahlia.ns.cloudflare.com<br>sid.ns.cloudflare.com</p>
</blockquote>
</li>
</ul>
<ul>
<li><p>Add DNS record</p>
<ul>
<li><p>DNS, add A record, set as ipfs.io IP(try <code>dig +short ipfs.io</code>)</p>
</li>
<li><p>DNS, add TXT record, use ipfs node name</p>
<blockquote>
<p>dnslink=/ipns/Qmdn4vrHjbmsQvHPXAiJvWFHQRqGd5fP33HJqd9AE4EjMH</p>
</blockquote>
</li>
<li><p>Crypto, set SSL as <code>full</code></p>
</li>
<li><p>Page Rules, add one rule</p>
<blockquote><p>ht<span>tp://</span>exa<span>mple.c</span>om/*<br>Always Use HTTPS</p>
</blockquote>
</li>
</ul>
</li>
</ul>
<ul>
<li>Wait for DNS effect</li>
</ul>
<h2 id="Setup-Gateway"><a href="#Setup-Gateway" class="headerlink" title="Setup Gateway"></a>Setup Gateway</h2><blockquote>
<p>If you want to build your own gateway, go on (not necessary)</p>
</blockquote>
<ul>
<li>Install Nginx<ul>
<li><code>apt install nginx-full</code></li>
</ul>
</li>
<li><p>Config Nginx</p>
<ul>
<li><p><code>vi /etc/nginx/sites-available/example_com</code></p>
<figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">upstream</span> ipfs-server &#123;</span><br><span class="line">    <span class="attribute">server</span> <span class="number">127.0.0.1:8080</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="attribute">map</span> <span class="variable">$http_upgrade</span> <span class="variable">$connection_upgrade</span> &#123;</span><br><span class="line">    <span class="attribute">default</span> upgrade;</span><br><span class="line">    ''      close;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="section">server</span> &#123;</span><br><span class="line">    <span class="attribute">listen</span> <span class="number">80</span>;</span><br><span class="line">    <span class="attribute">server_name</span> example.com;</span><br><span class="line"></span><br><span class="line">    <span class="attribute">location</span> / &#123;</span><br><span class="line">        <span class="attribute">proxy_set_header</span> X-Real-IP <span class="variable">$remote_addr</span>;</span><br><span class="line">        <span class="attribute">proxy_set_header</span> X-Forwarded-For <span class="variable">$proxy_add_x_forwarded_for</span>;</span><br><span class="line">        <span class="attribute">proxy_set_header</span> Host <span class="variable">$http_host</span>;</span><br><span class="line">        <span class="attribute">proxy_set_header</span> X-NginX-Proxy <span class="literal">true</span>;</span><br><span class="line">        <span class="attribute">proxy_pass</span> http://ipfs-server/;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>execute <code>nsite -e</code> <code>service nginx reload</code></p>
</li>
</ul>
</li>
</ul>
<h2 id="User-Experience"><a href="#User-Experience" class="headerlink" title="User Experience"></a>User Experience</h2><p>This site’s <a href="https://dengcb.net" target="_blank" rel="noopener">cloning</a> uses the IPFS, you can try.</p>
<p>The actual feeling, is different from we thought before. The first open takes a long time, always 504 timeout, but once connection is success, open will be very quick. Why? The IPFS official admits this is caused by the IPNS service bugs. We published name in the past, so we don’t need modify DNS while change files.</p>
<p>However, ipns service is very time-consuming and takes more than 1 minute often. Meanwhile, ipfs is almost seconds. <a href="https://ipfs.io" target="_blank" rel="noopener">IPFS Officle website</a> content is fixed, so hash address doesn’t change, using ipfs and open fast.</p>
<p>If, IPFS cannot enhance the speed of ipns service, first open needs ONE minute always, who can wait?</p>

    
    </div>
    
    <div class="columns is-variable is-1 is-multiline is-mobile">
    
        <span class="column is-narrow"><a class="tag is-light article-tag" href="/tags/tutorial/">#tutorial</a></span>
    
    </div>
    
    
    <div class="columns is-mobile is-multiline article-nav">
        <span class="column is-12-mobile is-half-desktop  article-nav-prev">
            
            <a href="/use-iterm2-telnet-smth-bbs/">Use iTerm2 to telnet SMTH bbs</a>
            
        </span>
        <span class="column is-12-mobile is-half-desktop  article-nav-next">
            
            <a href="/hexo-minos-multi-language/">Hexo multi-language with Minos</a>
            
        </span>
    </div>
    
</article>


<div class="sharebox">
    
<div class="sharethis-inline-share-buttons"></div>
<script type='text/javascript' src='//platform-api.sharethis.com/js/sharethis.js#property=5ad47e52d0b9d300137e38f0&amp;product=inline-share-buttons' async='async'></script>

</div>



<div class="comments">
    <h3 class="title is-4">Comments</h3>
    
<script>
    var disqus_config = function () {
        this.page.url = 'https://dengcb.com/bring-you-to-ipfs/';
        this.page.identifier = 'bring-you-to-ipfs/';
        
        this.language = 'en';
        
    };
    (function() {
        var d = document, s = d.createElement('script');  
        s.src = '//' + 'dengcb' + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>

<div id="disqus_thread">
    
    <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
</div>

    </div>
</section>
    <footer class="footer">
    <div class="container">
        <div class="columns content">
            <div class="column is-narrow has-text-centered">
                &copy; 2018 dengcb&nbsp;
                Powered by <a href="http://hexo.io/" target="_blank">Hexo</a> & <a
                        href="http://github.com/ppoffice/hexo-theme-minos">Minos</a>
            </div>
            <div class="column is-hidden-mobile"></div>

            
            
<div class="column is-narrow has-text-centered">
    <div class="dropdown is-up is-right is-hoverable" style="margin-top: -0.2em;">
        <div class="dropdown-trigger">
            <button class="button is-small" aria-haspopup="true" aria-controls="dropdown-menu7">
                <span class="icon">
                    <i class="fas fa-globe"></i>
                </span>
                <span>English</span>
                <span class="icon is-small">
            <i class="fas fa-angle-down" aria-hidden="true"></i>
          </span>
            </button>
        </div>
        <div class="dropdown-menu has-text-left" role="menu">
            <div class="dropdown-content">
            
                <a href="/bring-you-to-ipfs/" class="dropdown-item">
                    English
                </a>
            
                <a href="/zh/bring-you-to-ipfs/" class="dropdown-item">
                    简体中文
                </a>
            
            </div>
        </div>
    </div>
</div>

        </div>
    </div>
</footer>
    <script src="//cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>

<!-- test if the browser is outdated -->
<div id="outdated">
    <h6>Your browser is out-of-date!</h6>
    <p>Update your browser to view this website correctly. <a id="btnUpdateBrowser" href="http://outdatedbrowser.com/">Update my browser now </a></p>
    <p class="last"><a href="#" id="btnCloseUpdateBrowser" title="Close">&times;</a></p>
</div>
<script src="//cdnjs.cloudflare.com/ajax/libs/outdated-browser/1.1.5/outdatedbrowser.min.js"></script>
<script>
    $(document).ready(function () {
        //plugin function, place inside DOM ready function
        outdatedBrowser({
            bgColor: '#f25648',
            color: '#ffffff',
            lowerThan: 'flex'
        })
    });
</script>

<script>
    window.FontAwesomeConfig = {
        searchPseudoElements: true
    }
</script>


    
    
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/MathJax.js?config=TeX-MML-AM_CHTML"></script>
<script>
    MathJax.Hub.Config({
        "HTML-CSS": {matchFontHeight: false},
        SVG: {matchFontHeight: false},
        CommonHTML: {matchFontHeight: false}
    });
</script>

    
    
<script src="//cdnjs.cloudflare.com/ajax/libs/lightgallery/1.6.8/js/lightgallery-all.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/justifiedGallery/3.6.5/js/jquery.justifiedGallery.min.js"></script>
<script>
    (function ($) {
        $(document).ready(function () {
            if (typeof($.fn.lightGallery) === 'function') {
                $('.article.gallery').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof($.fn.justifiedGallery) === 'function') {
                $('.justified-gallery').justifiedGallery();
            }
        });
    })(jQuery);
</script>

    
    

    


<script src="/js/script.js"></script>

    
    <div class="searchbox ins-search">
    <div class="searchbox-mask"></div>
    <div class="searchbox-container ins-search-container">
        <div class="searchbox-input-wrapper">
            <input type="text" class="searchbox-input ins-search-input" placeholder="Type something..." />
            <span class="searchbox-close ins-close ins-selectable"><i class="fa fa-times-circle"></i></span>
        </div>
        <div class="searchbox-result-wrapper ins-section-wrapper">
            <div class="ins-section-container"></div>
        </div>
    </div>
</div>
<script>
    (function (window) {
        var INSIGHT_CONFIG = {
            TRANSLATION: {
                POSTS: 'Posts',
                PAGES: 'Pages',
                CATEGORIES: 'Categories',
                TAGS: 'Tags',
                UNTITLED: '(Untitled)',
            },
            CONTENT_URL: '/content.json',
        };
        window.INSIGHT_CONFIG = INSIGHT_CONFIG;
    })(window);
</script>
<script src="/js/insight.js"></script>
    
</body>
</html>